<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="vi">

	<head>
		<meta http-equiv="Content-Type" content="text/html" ; charset="UTF-8" />
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<!-- External CSS Document(s) -->
		<link rel="stylesheet" type="text/css" href="css/styles.css" />
		<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Quicksand:wght@500&display=swap" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
		<title>Spark - Nh·∫≠t k√Ω H·ªôi h·ªça | Sereny</title>

		<!-- Eternal JavaScript Document(s) -->
		<script type="text/javascript" src="journal/js/canvas.js"></script>

		<style>
			@charset "UTF-8";

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
				font-family: 'Patrick Hand', sans-serif;
				color: #2c2c2c;
				letter-spacing: 0.05em;
				line-height: 2em;
				font-weight: 500px;
			}

			.section {
				padding-top: 5px;
				padding-bottom: 5px;
				margin: 0 auto;
				width: 80%;
				max-width: 700px;
				text-align: center;
			}

			p {
				font-size: 25px;
			}

			body {
				background-color: #f7cac9;
			}

			.button {
				padding: 6px 20px;
				font-size: 14px;
				font-weight: 600;
				letter-spacing: 1px;
				color: #F7CAC9;
				background: #343148;
				border-radius: 0;
				transition: .3s;
				font-family: inherit;
				display: inline;
				text-align: center;
				text-decoration: none;
				outline: none;
			}

			.button:hover {
				color: #343148;
				background: #ffffff;
			}

			h1 {
				text-align: center;
				color: rgb(255, 109, 109);
				font-size: 50px;

			}

			textarea {
				width: 700px;
				height: 700px;
				resize: none;
				border-radius: 16px;
				border: 0px;
				padding: 30px 30px;
				font-family: inherit;
				font-size: 20px;
				text-transform: none;
			}

			textarea:focus {
				outline: none;
			}

			#quote {
				text-align: center;
				margin: 0 auto;
				padding: 5%;
				font-size: 16px;
				background-color: white;
				border-radius: 16px;
				width: 80%;
			}

			::placeholder {
				opacity: 0.6;
			}


			#wrapper {
				position: relative;
				margin: 0 auto;
				max-width: 900px;
			}

			/* placeholder for canvas element */
			#canvasPlaceholder {
				width: 700px;
				height: 600px;
				border-radius: 16px;
				margin: auto;
				cursor: crosshair;
			}

			#buttons {
				position: absolute;
				z-index: 2;
				line-height: 0;
				vertical-align: middle;
				display: flex;
				flex-direction: column;
				width: 10%;
				max-width: 100px;
				margin: 0 auto;
				margin-top: 10px;
			}

			.canvasButton {
				cursor: pointer;
				opacity: 0.6;
				text-decoration: none;
				outline: none;
				color: none;
				background-color: Transparent;
				border: none;
				margin: 20%;
				-moz-user-select: -moz-none;
				-khtml-user-select: none;
				-webkit-user-select: none;
				-ms-user-select: none;
				user-select: none;
			}

			.canvasButton:hover {
				opacity: 0.4;
			}

			.canvasButton:active {
				opacity: 0.8;
			}
			
			::selection {
				background: #fbf0fb;
			}
			


			/* drawing canvas element visible to user */
			#drawingCanvas {
				width: 700px;
				height: 600px;
				border-radius: 16px;
				position: absolute;
				overflow: visible;
				background-color: transparent;
			}

			/* temporary canvas being updated every time user draws */
			#tempCanvas {
				position: absolute;
				width: 700px;
				height: 600px;
				border-radius: 16px;
				overflow: visible;
			}

			.noscript {
				font-size: 14px;
			}
		</style>

	</head>

	<body>

		<!-- return prev page -->
		<a href="morning.html" class="return">
			<i class="fas fa-arrow-circle-left">
			</i>
		</a>
		<style>
			a {
			color: #000000!important;
			}

			.return {
			padding-left: 15px;
			font-size: 20px;
			font-weight: 500px;
			text-decoration: none;
			font-family: 'Patrick Hand', sans-serif;
			}

			i:hover {
			color: rgb(255, 109, 109);
			}

		</style>
		<!-- random prompts given to the user. a new one can be requested by pressing the button-->
		<div class="section">
			<h1>üí≠ G·ª£i √Ω cho Nh·∫≠t k√≠ c·ªßa b·∫°n üí≠</h1>
			<div id="prompt"></div>
		</div>

		<div class="section">
			<button class="button" id="getPrompt" button onclick="getPrompt()">
				Thay ƒë·ªïi G·ª£i √Ω</button>
		</div>


		<script>
			function getPrompt() {
				var prompts = [];
				prompts.push("H√£y k·ªÉ v·ªÅ t√¢m tr·∫°ng c·ªßa b·∫°n h√¥m nay!");
				prompts.push("H√£y k·ªÉ v·ªÅ gi·∫•c m∆° g·∫ßn ƒë√¢y nh·∫•t m√† b·∫°n nh·ªõ!");
				prompts.push("H√£y k·ªÉ v·ªÅ nh·ªØng m√≥n qu√† b·∫°n mong ch·ªù ƒë∆∞·ª£c t·∫∑ng trong t∆∞∆°ng lai!");
				prompts.push("H√£y k·ªÉ v·ªÅ nh·ªØng ∆∞·ªõc mu·ªën v√† d·ª± ƒë·ªãnh trong t∆∞∆°ng lai c·ªßa b·∫°n!");
				prompts.push("H√£y k·ªÉ v·ªÅ m·ªôt k√≠ ·ª©c tu·ªïi th∆° m√† b·∫°n y√™u th√≠ch nh·∫•t!");
				prompts.push("H√£y k·ªÉ m·ªôt ƒëi·ªÅu b·∫°n ƒë√£ t·ª´ng ∆∞·ªõc m∆° khi c√≤n b√©!");
				prompts.push("N·∫øu nh∆∞ b·∫°n c√≥ m·ªôt c√¢y ƒë≈©a th·∫ßn c√≥ th·ªÉ bi·∫øn m·ªçi ∆∞·ªõc m∆° c·ªßa b·∫°n th√†nh hi·ªán th·ª±c, v√† kh√¥ng m·ªôt ai tr√™n v≈© tr·ª• n√†y bi·∫øt v·ªÅ c√¢y ƒë≈©a ·∫•y ngo√†i b·∫°n, b·∫°n s·∫Ω l√†m g√¨?");
				prompts.push("Ai/ ƒêi·ªÅu g√¨ lu√¥n lu√¥n t·∫°o ƒë·ªông l·ª±c cho b·∫°n?");
				prompts.push("B·∫°n c·∫£m th·∫•y v√¥ t∆∞ hay n·∫∑ng n·ªÅ v·ªÅ m·∫∑t t√¨nh c·∫£m? H√£y v·∫Ω m·ªôt th·ª© g√¨ ƒë√≥ nh·∫π ho·∫∑c n·∫∑ng th·ªÉ hi·ªán c·∫£m gi√°c c·ªßa b·∫°n.");
				prompts.push("B·∫°n c√≥ m·ªôt ƒë·ªì v·∫≠t g√¨ ƒë√≥ quan tr·ªçng v·ªÅ m·∫∑t t√¨nh c·∫£m ·ªü g·∫ßn b·∫°n kh√¥ng? H√£y v·ªÅ ƒë·ªì v·∫≠t ·∫•y ho·∫∑c m·ªôt k·ª∑ ni·ªám g·∫Øn li·ªÅn v·ªõi n√≥.");
				prompts.push("V·∫Ω l·∫°i m·ªôt m·ªôt s·ª± ki·ªán n√†o ƒë√≥ t·ª´ tu·∫ßn tr∆∞·ªõc v√† vi·∫øt l·∫°i t√¢m tr·∫°ng c·ªßa b·∫°n l√∫c ƒë√≥?");
				prompts.push("N·∫øu b·∫°n l√† m·ªôt con v·∫≠t, b·∫°n s·∫Ω ch·ªçn l√† con g√¨? Con v·∫≠t ƒë√≥ t∆∞·ª£ng tr∆∞ng cho ƒëi·ªÅu g√¨ ƒë·ªëi v·ªõi b·∫°n?");
				prompts.push("N·∫øu b·∫°n ph·∫£i ch·ªçn m·ªôt th·∫ø gi·ªõi h∆∞ c·∫•u ƒë·ªÉ s·ªëng, th·∫ø gi·ªõi ·∫•y s·∫Ω ·ªü ƒë√¢u? B·∫°n s·∫Ω th√™m nh·ªØng y·∫øu t·ªë g√¨ ƒë·ªÉ l√†m cho th·∫ø gi·ªõi h∆∞ c·∫•u ·∫•y l√† n∆°i ƒë√°ng s·ªëng nh·∫•t ƒë·ªëi v·ªõi b·∫°n?");
				prompts.push("V·∫Ω nh·ªØng v√≤ng tr√≤n c√πng v·ªõi h∆°i th·ªü c·ªßa b·∫°n. B·∫Øt ƒë·∫ßu khi b·∫°n h√≠t v√†o v√† th·ªü ra khi th·ª±c hi·ªán xong m·ªôt n·ª≠a v√≤ng tr√≤n. K·∫øt th√∫c th·ªü ra v√† ho√†n th√†nh n·ª≠a v√≤ng tr√≤n c√≤n l·∫°i.");
				prompts.push("H√£y s√°ng t√°c m·ªôt c√¢u chuy·ªán b·∫Øt ƒë·∫ßu v√†o m·ªôt ng√†y l·∫°nh nh·∫•t c·ªßa m√πa ƒë√¥ng. N√≥i v·ªÅ nh·ªØng g√¨ nh√¢n v·∫≠t c·ªßa b·∫°n l√†m ƒë·ªÉ gi·ªØ ·∫•m v√† nh·ªØng cu·ªôc phi√™u l∆∞u x·∫£y ra v√†o ng√†y ƒë·∫ßy b√¥ng tuy·∫øt n√†y.");
				prompts.push("H√£y vi·∫øt v·ªÅ m·ªôt ƒë·ªì ƒÉn b·∫°n s·∫Ω kh√¥ng bao gi·ªù th·ª≠ v√† k·ªÉ l√≠ do v√¨ sao.");
				prompts.push("B·∫°n c·∫£m th·∫•y th·∫ø n√†o khi l√†m vi·ªác nh√≥m trong m·ªôt d·ª± √°n c·ªông ƒë·ªìng? B·∫°n nghƒ© s·∫Ω c√≥ nh·ªØng b·∫•t ƒë·ªìng g√¨ c√≥ th·ªÉ x·∫£y ra? N·∫øu ƒë∆∞·ª£c tr·ªü th√†nh l√£nh ƒë·∫°o c·ªßa d·ª± √°n, b·∫°n s·∫Ω l√†m g√¨ ƒë·ªÉ h√≥a gi·∫£i nh·ªØng b·∫•t ƒë·ªìng ·∫•y?.");

				var prompt = prompts[Math.floor(Math.random() * prompts.length)];

				document.getElementById("prompt")
					.innerHTML = '<p>' + prompt + '</p>';
			}
		</script>


		<!-- canvas heading -->
		<h1>üé® B·∫£ng v·∫Ω üé®</h1>

		<!-- canvas features, such as draw, eraser, increase pen stroke, and clear canvas -->
		<div id="wrapper">
			<div id="buttons">
				<button class="canvasButton" id="pen">
					<img style="width: 100%" src="https://cdn.discordapp.com/attachments/802400122889699328/802813463381934120/paint-brush.png" onclick="tool = pen; context.strokeStyle = '#514d44';" />
				</button>

				<button class="canvasButton" id="eraser">
					<img style="width: 100%" src="https://cdn.discordapp.com/attachments/802400122889699328/802813695267831848/eraser.png" onclick="context.strokeStyle = '#FFF';" />
				</button>

				<button class="canvasButton">
					<img style="width: 100%" src="https://cdn.discordapp.com/attachments/802400122889699328/802783792820387870/smol_circle.png" onclick="context.lineWidth--;" />
				</button>

				<button class="canvasButton">
					<img style="width: 100%" src="https://cdn.discordapp.com/attachments/802400122889699328/802783752602386452/circle.png" onclick="context.lineWidth++;" />
				</button>

				<button class="canvasButton" id="clear_canvas" button onclick="clear_canvas()">
					<img style="width: 100%" src="https://img.icons8.com/wired/512/000000/trash.png" style='transform:translate(0px, 3px)' />
				</button>

			</div>


			<div id="canvasPlaceholder">
				<!-- text after noscript will appear if user is not using a browser compatible with html canvas -->

				<canvas id="drawingCanvas" height="600px" width="700px">
					<p class="noscript">Sereny Team ch√¢n th√†nh xin l·ªói b·∫°n! Hi·ªán t·∫°i tr√¨nh duy·ªát c·ªßa b·∫°n ch∆∞a t∆∞∆°ng th√≠ch v·ªõi website c·ªßa ch√∫ng t√¥i. ƒê·ªÉ c√≥ th·ªÉ truy c·∫≠p website, h√£y s·ª≠ d·ª•ng m·ªôt tr√¨nh duy·ªát kh√°c t∆∞∆°ng th√≠ch. <br />D∆∞·ªõi ƒë√¢y l√† danh s√°ch nh·ªØng tr√¨nh duy·ªát t∆∞∆°ng th√≠ch <a href="http://www.google.com/chrome">Google Chrome</a>, <a href="http://www.opera.com">Opera</a>, <a href="http://www.mozilla.com">Firefox</a>, <a href="http://www.apple.com/safari">Safari</a>, <br />and <a href="http://www.konqueror.org">Konqueror</a>. B√™n c·∫°nh ƒë√≥, h√£y ch·∫Øc ch·∫Øn r·∫±ng JavaScript c·ªßa b·∫°n ƒëang ƒë∆∞·ª£c b·∫≠t. <br/>Xin c·∫£m ∆°n b·∫°n!</p>
				</canvas>
			</div>

			<!-- interactive button for saving canvas -->
			<div class="section">
				<button class="button" id="save canvas" button onclick="save_img()">
					L∆∞u B·∫£ng v·∫Ω</button>
			</div>
		</div>

		<!-- journal element -->
		<div class="section">
			<h1>üìÉ Nh·∫≠t k√≠ üìÉ</h1>
			<textarea id="journal" textarea name="journal" placeholder="Nh·∫≠p v√†o ƒë√¢y nha ~" spellcheck="false"></textarea>

			<div class="section">

				<!-- interactive button for saving journal -->
				<button class="button" id="save journal" button onclick="save_journal()">
					L∆∞u Nh·∫≠t k√≠</button>
			</div>
		</div>


		<!-- script file for drawing canvas, saving canvas, and saving journal -->
		<script>
			var context;

			// if window can add event listener, then load an event listener and initialize canvas
			if (window.addEventListener) {
				window.addEventListener('load', function () {

					var canvas, canvaso, contexto;

					var tool;
					var tool_default = 'pen';

					// initializes canvas
					function init() {
						canvaso = document.getElementById('drawingCanvas');

						if (!canvaso) {
							alert('Error! Canvas element not found.');
							return;
						}
						if (!canvaso.getContext) {
							alert('Error! No canvas.getContext!');
							return;
						}

						contexto = canvaso.getContext('2d');
						if (!contexto) {
							alert('Error! Failed to getContext!');
							return;
						}

						var container = canvaso.parentNode;
						canvas = document.createElement('canvas');
						if (!canvas) {
							alert('Error! Cannot create a new canvas element!');
							return;
						}

						canvas.id = 'tempCanvas';
						canvas.width = canvaso.width;
						canvas.height = canvaso.height;
						container.appendChild(canvas);
						context = canvas.getContext('2d');

						// set defaults
						context.strokeStyle = "#767676"
						context.lineWidth = 5.0;

						// set canvas
						context.fillStyle = "#FFF";
						context.fillRect(0, 0, canvas.width, canvas.height);

						// set default tool
						var tool_select = document.getElementById('pen');
						if (!tool_select) {
							alert('Error! Failed to get the select element!');
							return;
						}

						// add an event listener to the current tool selected
						tool_select.addEventListener('change', ev_tool_change, false);

						// if the default tool isn't null, then set current tool to default(?)
						if (tools[tool_default]) {
							tool = new tools[tool_default]();
							tool_select.value = tool_default;
						}

						// event listeners for pressing down on mouse, moving mouse, and pressing off of mouse
						canvas.addEventListener('mousedown', ev_canvas, false);
						canvas.addEventListener('mousemove', ev_canvas, false);
						canvas.addEventListener('mouseup', ev_canvas, false);

						// initializes a prompt on load
						getPrompt();

					}

					function ev_canvas(ev) {
						if (ev.layerX || ev.layerX == 0) { // Firefox 
							ev._x = ev.layerX;
							ev._y = ev.layerY;
						} else if (ev.offsetX || ev.offsetX == 0) { // Opera 
							ev._x = ev.offsetX;
							ev._y = ev.offsetY;
						}

						// get the tool's event handler. 
						var func = tool[ev.type];
						if (func) {
							func(ev);
						}
					}

					// changes current tool (not necessary for current implementation)
					function ev_tool_change(ev) {
						if (tools[this.value]) {
							tool = new tools[this.value]();
						}
					}

					// create the temporary canvas on top of the canvas, which is cleared each time the user draws so a new canvas can be drawn
					function img_update() {
						contexto.drawImage(canvas, 0, 0);
						context.clearRect(0, 0, canvas.width, canvas.height);
					}

					// list of tools
					var tools = {};

					// pen tool's functionality
					tools.pen = function () {
						var tool = this;
						this.started = false;

						// registers mouse has been clicked and will start to move
						this.mousedown = function (ev) {
							context.beginPath();
							context.moveTo(ev._x, ev._y);
							tool.started = true;
						};

						// draws with pen tool while mouse is moving, if mouse has been clicked
						this.mousemove = function (ev) {
							if (tool.started) {
								context.lineTo(ev._x, ev._y);
								context.stroke();
							}
						};

						// registers mouse is no longer being pressed, and will stop
						this.mouseup = function (ev) {
							if (tool.started) {
								tool.mousemove(ev);
								tool.started = false;
								img_update();
							}
						};
					};

					init();

				}, false);
			}

			// saves canvas to a png file
			function save_img() {
				// gets canvas element and converts it into a dataURL
				var canvas = document.getElementById('drawingCanvas');
				var data = canvas.toDataURL('image/png');

				// creates an element of type link
				var a = document.createElement('a');
				// sets its link to the converted canvas data
				a.href = data;
				// sets file name to be downloaded
				a.download = 'emotions.png';
				// executes link
				a.click();
			}

			// clears canvas
			function clear_canvas() {
				// gets canvas element 
				var canvas = document.getElementById('drawingCanvas');
				// gets contents of canvas
				var context = canvas.getContext('2d');
				// sets fill style to be white
				context.fillStyle = "#FFF";
				// fills the canvas 
				context.fillRect(0, 0, canvas.width, canvas.height);
			}

			// saves journal entry to a txt file
			function save_journal() {
				// gets textarea's value 
				var text = document.getElementById("journal")
					.value;

				// retains all line breaks to keep journal consistent
				text = text.replace(/\n/g, "\r\n");

				// TODO: comment
				var blob = new Blob([text], { type: "text/plain" });
				var anchor = document.createElement("a");
				anchor.download = "journal-entry.txt";
				anchor.href = window.URL.createObjectURL(blob);
				anchor.target = "_blank";
				anchor.style.display = "none"; // just to be safe!
				document.body.appendChild(anchor);
				anchor.click();
				document.body.removeChild(anchor);
			}
		</script>


	</body>

</html>